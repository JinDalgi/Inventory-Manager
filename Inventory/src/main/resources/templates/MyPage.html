<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>User Info</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<h1>User Information</h1>
<div id="userInfo">
    <p id="userEmail">Email: </p>
    <p id="userName">Username: </p>
</div>
<button id="deleteUserButton"> 회원 탈퇴 </button>


<script th:inline="javascript">
    // Axios를 사용하여 JSON 데이터 가져오기

    axios.get('/sign-api/MyPage')
        .then(function(response) {

            var user = response.data;

            const p1 = document.getElementById("userEmail");
            const p2 = document.getElementById("userName");

            const userEmail = document.createElement('span');
            userEmail.innerText = user.email;

            const userName = document.createElement('span');
            userName.innerText =user.username;

            p1.appendChild(userEmail);
            p2.appendChild(userName);

        })
        .catch(function(error) {
            console.error('Error fetching user data:', error);
        });

    // 회원 탈퇴 버튼
    const deleteUserButton = document.getElementById("deleteUserButton");
    deleteUserButton.addEventListener("click", function () {
        axios.delete('/sign-api/MyPage/delete')
            .then(function (response) {
                alert("회원탈퇴에 성공하였습니다.");
                // 회원 탈퇴 성공 시 메인페이지로
                window.location.href = '/index';
            })
            .catch(function (error) {
                var errorMsg = new Error('회원 탈퇴 중 오류가 발생했습니다.');
                alert(errorMsg.message);
            })
    })

</script>
</body>
</html>
